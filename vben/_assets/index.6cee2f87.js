import{k as e,q as t,X as n,u as o,a0 as r,f as a,a as l,aM as s,Y as i,bv as c,by as u,b as f,K as d,I as p,r as m,p as g,a8 as b,a9 as h,bz as y,bA as v,V as w,ax as O,Z as L,ai as x,bB as H,bC as S,aq as j,bD as C,au as P,t as F,bE as k,v as M}from"./index.5b8fca6f.js";import{C as B}from"./CloseOutlined.475fdade.js";import{B as E}from"./index.673b0fc4.js";import{u as T}from"./useTimeout.6ae13814.js";import{u as z}from"./useDebounce.0471ae6a.js";import{a as N,r as W}from"./resizeEvent.028e8d76.js";import{e as A,g as $}from"./tsxHelper.4d563b73.js";import{p as q}from"./propTypes.4631211a.js";import{B as R}from"./index.b0708075.js";import{u as I}from"./useWindowSizeFn.26af1d48.js";var D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(o,r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){X(e,t,n[t])}))}return e}({},o,r.attrs);return e(n,t(a,{icon:D}),null)};Y.displayName="FullscreenExitOutlined",Y.inheritAttrs=!1;var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V=function(o,r){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){K(e,t,n[t])}))}return e}({},o,r.attrs);return e(n,t(a,{icon:G}),null)};V.displayName="FullscreenOutlined",V.inheritAttrs=!1;const{t:Z}=o(),J={visible:q.bool,draggable:q.bool.def(!0),centered:q.bool,cancelText:q.string.def(Z("component.modal.cancelText")),okText:q.string.def(Z("component.modal.okText")),closeFunc:Function},Q=Object.assign({},J,{canFullscreen:q.bool.def(!0),wrapperFooterOffset:q.number.def(0),helpMessage:[String,Array],useWrapper:q.bool.def(!0),loading:q.bool,showCancelBtn:q.bool.def(!0),showOkBtn:q.bool.def(!0),wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:Boolean,destroyOnClose:Boolean,footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:Boolean,width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function U(e){const t=(e,t)=>getComputedStyle(e)[t],n=n=>{if(!n)return;n.setAttribute("data-drag",a(e.draggable));const o=n.querySelector(".ant-modal-header"),r=n.querySelector(".ant-modal");o&&r&&a(e.draggable)&&(o.style.cursor="move",o.onmousedown=e=>{if(!e)return;const n=e.clientX,o=e.clientY,a=document.body.clientWidth,l=document.documentElement.clientHeight,s=r.offsetWidth,i=r.offsetHeight,c=r.offsetLeft,u=a-r.offsetLeft-s,f=r.offsetTop,d=l-r.offsetTop-i,p=t(r,"left"),m=t(r,"top");let g=+p,b=+m;p.includes("%")?(g=+document.body.clientWidth*(+p.replace(/%/g,"")/100),b=+document.body.clientHeight*(+m.replace(/%/g,"")/100)):(g=+p.replace(/px/g,""),b=+m.replace(/px/g,"")),document.onmousemove=function(e){let t=e.clientX-n,a=e.clientY-o;-t>c?t=-c:t>u&&(t=u),-a>f?a=-f:a>d&&(a=d),r.style.cssText+=`;left:${t+g}px;top:${a+b}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};r((()=>{a(e.visible)&&a(e.draggable)&&T((()=>{(()=>{const o=document.querySelectorAll(".ant-modal-wrap");for(const r of Array.from(o)){if(!r)continue;const o=t(r,"display"),l=r.getAttribute("data-drag");"none"!==o&&(null===l||a(e.destroyOnClose))&&n(r)}})()}),30)}))}var _=l({name:"Modal",inheritAttrs:!1,props:Q,setup(e,{attrs:t,slots:n}){const{visible:o,draggable:r,destroyOnClose:a}=s(e);return U({visible:o,destroyOnClose:a,draggable:r}),()=>{const o={...t,...e};return i(c,{...o},A(n))}}});const ee=(e,t=Symbol(),n=!0)=>{const o=f({...e}),r=n?u(o):o;d(t,r)},te=(e=Symbol(),t,n=!0)=>{const o=p(e,t||{});return n?u(o):o},ne=Symbol();function oe(){return te(ne)}var re=l({name:"ModalWrapper",props:{loading:q.bool,modalHeaderHeight:q.number.def(50),modalFooterHeight:q.number.def(54),minHeight:q.number.def(200),footerOffset:q.number.def(0),visible:q.bool,fullScreen:q.bool},emits:["heightChange","getExtHeight"],setup(e,{slots:t,emit:n}){const o=m(null),l=m(null),s=m(0);let c=()=>{};I(f),ee({redoModalHeight:f},ne);const u=g((()=>({minHeight:`${e.minHeight}px`,height:`${a(s)}px`,overflow:"auto"})));async function f(){if(!e.visible)return;const t=a(o);if(!t)return;const r=t.parentElement;if(r){r.style.padding="0",await w();try{const t=r.parentElement&&r.parentElement.parentElement;if(!t)return;const o=getComputedStyle(t).top,i=Number.parseInt(o);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),await w();const u=a(l);if(!u)return;const f=u.$el.querySelector(".ant-spin-container");if(!f)return;const d=f.scrollHeight;e.fullScreen?s.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight:s.value=d>c?c:d+16+30,n("heightChange",a(s)),w((()=>{const e=u.$el;e&&(e.style.height=`${a(s)}px`)}))}catch(e){}}}return r((()=>{f()})),b((()=>e.fullScreen),(e=>{!e&&f()})),h((()=>{const{modalHeaderHeight:t,modalFooterHeight:r}=e;n("getExtHeight",t+r),function(){const e=a(o);if(!e)return;const t=e.querySelector(".ant-spin-container");if(!t)return;const[n,r]=function(e,t,n=100,o){let r=()=>{t()};const[a,l]=z(r,n,o);return r=n?a:r,[function(){N(e,r)},function(){W(e,r),l()}]}(t,(()=>{f()}));c=r,n()}()})),y((()=>{c&&c()})),()=>i("div",{ref:o,style:a(u)},i(v,{ref:l,spinning:e.loading},(()=>$(t))))}});var ae=l({name:"BasicModal",props:Q,emits:["visible-change","height-change","cancel","ok","register"],setup(e,{slots:t,emit:n,attrs:o}){const l=m(!1),s=m(null),c=m(null),u=m(0),f=g((()=>({...e,...a(s)}))),{handleFullScreen:d,getWrapClassName:p,fullScreenRef:h}=function(e){const t=m(0),n=m(!1);return{getWrapClassName:g((()=>{const t=a(e.wrapClassName)||"";return a(n)?`fullscreen-modal ${t} `:a(t)})),handleFullScreen:function(o){o&&o.stopPropagation(),n.value=!a(n);const r=a(e.modalWrapperRef);if(!r)return;const l=r.$el;if(!l)return;const s=l.querySelector(".ant-spin-nested-loading");s&&(!a(t)&&a(n)&&(t.value=s.offsetHeight),a(n)?s.style.height=window.innerHeight-a(e.extHeightRef)+"px":s.style.height=`${a(t)}px`)},fullScreenRef:n}}({modalWrapperRef:c,extHeightRef:u,wrapClassName:O(f.value,"wrapClassName")}),y=g((()=>({...{...a(f),visible:a(l),title:void 0},wrapClassName:a(p)}))),v=g((()=>({...o,...a(y)})));async function w(t){if(null==t||t.stopPropagation(),e.closeFunc&&x(e.closeFunc)){const t=await e.closeFunc();l.value=!t}else l.value=!1,n("cancel")}r((()=>{l.value=!!e.visible})),b((()=>a(l)),(e=>{n("visible-change",e)}),{immediate:!1});const j={setModalProps:function(e){s.value=S(a(s)||{},e),Reflect.has(e,"visible")&&(l.value=!!e.visible)}};return H((e=>{n("register",j,e.uid)})),()=>i(_,{onCancel:w,...a(v)},{footer:()=>function(){const{showCancelBtn:e,cancelButtonProps:o,cancelText:r,showOkBtn:l,okType:s,okText:c,okButtonProps:u,confirmLoading:f}=a(y);return i(L,null,$(t,"insertFooter"),e&&i(R,{...o,onClick:w},(()=>r)),$(t,"centerdFooter"),l&&i(R,{type:s,loading:f,onClick:()=>{n("ok")},...u},(()=>c)),$(t,"appendFooter"))}(),closeIcon:()=>function(){const{canFullscreen:e}=a(y),t=a(h)?i(Y,{role:"full",onClick:d}):i(V,{role:"close",onClick:d});return i("div",{class:["custom-close-icon",{"can-full":e}]},e&&t,i(B,{onClick:w}))}(),title:()=>function(){const{helpMessage:e}=a(y),{title:n}=a(f);return i(E,{helpMessage:e},(()=>t.title?$(t,"title"):n))}(),...A(t,["default"]),default:()=>function(){const{useWrapper:o,loading:r,wrapperProps:s}=a(y);if(!o)return $(t);const f=void 0===e.footer||e.footer?void 0:0;return i(re,{footerOffset:e.wrapperFooterOffset,fullScreen:a(h),ref:c,loading:r,visible:a(l),modalFooterHeight:f,...s,onGetExtHeight:e=>{u.value=e},onHeightChange:e=>{n("height-change",e)}},(()=>$(t)))}()})}});const le=f({});function se(){if(!j())throw new Error("Please put useModal function in the setup function!");const e=m(null),t=m(!1),n=m("");const o=()=>{const t=a(e);if(!t)throw new Error("instance is undefined!");return t};return[function(o,r){n.value=r,y((()=>{e.value=null,t.value=!1,le[a(n)]=null})),a(t)&&C()&&o===a(e)||(e.value=o)},{setModalProps:e=>{o().setModalProps(e)},openModal:(e=!0,t,r=!1)=>{if(o().setModalProps({visible:e}),!t)return;if(r)return le[a(n)]=null,void(le[a(n)]=t);P(F(le[a(n)]),t)||(le[a(n)]=t)}}]}const ie=e=>{const t=m(null),n=j(),o=m("");if(!n)throw new Error("instance is undefined!");const l=()=>{const e=a(t);if(!e)throw new Error("instance is undefined!");return e};return r((()=>{const t=le[a(o)];t&&e&&x(e)&&w((()=>{e(t)}))})),[(e,r)=>{k((()=>{t.value=null})),o.value=r,t.value=e,n.emit("register",e)},{changeLoading:(e=!0)=>{l().setModalProps({loading:e})},changeOkLoading:(e=!0)=>{l().setModalProps({confirmLoading:e})},closeModal:()=>{l().setModalProps({visible:!1})},setModalProps:e=>{l().setModalProps(e)}}]},ce=M(ae);export{ce as B,V as F,te as a,se as b,ee as c,Y as d,oe as e,ie as u};